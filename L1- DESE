##Department of Elementary and Secondary Education exercises 1-13

(13) SELECT "district_id", "per_pupil_expenditure", "pupils", "exemplary", "unsatisfactory"
     FROM "expenditures"
     NATURAL JOIN "staff_evaluations"
      ORDER BY "per_pupil_expenditure" DESC, "exemplary" DESC
      LIMIT 20;

(12) SELECT "name", "per_pupil_expenditure", "exemplary"
     FROM "districts"
     JOIN "expenditures" ON "districts"."id" = "expenditures"."district_id"
     JOIN "staff_evaluations" ON "expenditures"."district_id" = "staff_evaluations"."district_id"
       WHERE "type" = 'Public School District' 
       AND "per_pupil_expenditure" > (SELECT AVG(per_pupil_expenditure) FROM "expenditures")
       AND "exemplary" > (SELECT AVG(exemplary) FROM "staff_evaluations")
       ORDER BY "exemplary" DESC, "per_pupil_expenditure" DESC;

(11) SELECT "name", "per_pupil_expenditure", "graduated" 
     FROM "expenditures" 
     JOIN "schools" ON "expenditures"."district_id" = "schools"."district_id" 
     JOIN "graduation_rates" ON "schools"."id" = "graduation_rates"."school_id" 
      ORDER BY "per_pupil_expenditure" DESC, "name";

(10) SELECT "name", "per_pupil_expenditure"
     FROM "districts"
     JOIN "expenditures" ON "districts"."id" = "expenditures"."district_id"
      WHERE "type" = 'Public School District'
      ORDER BY "per_pupil_expenditure" DESC
      LIMIT 10;

(9) SELECT "districts"."name" 
    FROM "districts" 
    JOIN "expenditures" ON "districts"."id" = "expenditures"."district_id" 
    ORDER BY "expenditures"."pupils" 
    LIMIT 1;

(8) SELECT "districts"."name", "expenditures"."pupils"
    FROM "districts"
    JOIN "expenditures" ON "districts"."id" = "expenditures"."district_id";

(7) SELECT "name" FROM "schools" WHERE "district_id" = (SELECT "id" FROM "districts" WHERE "name" = 'Cambridge');

(6) SELECT "name" FROM "schools" WHERE "id" IN (SELECT "school_id" FROM "graduation_rates" WHERE "graduated" = 100);

(5) SELECT "city", COUNT(name) FROM "schools" WHERE "type" = 'Public School' 
    GROUP BY "city" HAVING COUNT(name) <= 3 
    ORDER BY COUNT(name) DESC, "city";

(4) SELECT "city", COUNT(name) FROM "schools" WHERE "type" = 'Public School' 
    GROUP BY "city" 
    ORDER BY COUNT(name) DESC, "city" 
    LIMIT 10;

(3) SELECT AVG("per_pupil_expenditure") AS "Average District Per-Pupil Expenditure" FROM "expenditures";

(2) SELECT "name" FROM "districts" WHERE "name" LIKE "%non-op%";

(1) SELECT "name", "city" FROM "schools" WHERE "type" = 'Public School' AND "state" = 'MA';
